# MinPad - 数字键盘快捷操作工具

一个基于Java原生组件开发的Windows快捷键工具，通过数字键盘快速执行常用操作。

## 功能特性

- ✅ **全局键盘监听**：监听数字键盘（NumPad）按键，完全拦截防止其他应用接收
- ✅ **系统托盘运行**：最小化到系统托盘，不占用任务栏
- ✅ **可自定义配置**：通过GUI界面配置每个按键的操作
- ✅ **执行任意程序**：可以启动任何Windows程序或命令
- ✅ **组合键映射**：支持模拟组合键如 `ctrl+shift+a`、`alt+tab` 等
- ✅ **长按连续触发**：NumPad +/- 长按时连续调节音量，松开立即停止
- ✅ **音量控制**：内置 NumPad +/- 快速调节系统音量
- ✅ **媒体控制**：NumPad Enter 默认实现播放/暂停功能
- ✅ **中文支持**：完整的中文界面和菜单
- ✅ **轻量级**：使用Java Swing原生组件，无外部依赖

## 默认快捷键

| 按键 | 功能 | 说明 |
|------|------|------|
| NumPad 0 | 显示测试通知 | 可自定义 |
| NumPad 1 | 打开记事本 | 可自定义 |
| NumPad 2 | 打开计算器 | 可自定义 |
| NumPad 3 | 打开浏览器 | 可自定义 |
| NumPad 4 | 打开资源管理器 | 可自定义 |
| NumPad 5 | 打开命令提示符 | 可自定义 |
| NumPad 6-9 | 未配置 | 可自定义 |
| NumPad + | **增加音量** | 支持长按连续调节，默认每次 1 格，可自定义 |
| NumPad - | **减少音量** | 支持长按连续调节，默认每次 1 格，可自定义 |
| NumPad * | 未配置 | 可自定义 |
| NumPad / | 未配置 | 可自定义 |
| NumPad Enter | **播放/暂停** | 默认控制音乐播放/暂停，可自定义 |

## 系统要求

- Windows 7/8/10/11
- Java 11 或更高版本
- Maven 3.6+ (用于构建)

## 构建与运行

### 1. 构建项目

```bash
mvn clean package
```

### 2. 运行程序

```bash
java -jar target/minpad-1.0.0.jar
```

或者直接双击生成的 JAR 文件。

### 3. 设置开机自启动（可选）

1. 按 `Win + R` 打开运行对话框
2. 输入 `shell:startup` 并回车
3. 将 `minpad-1.0.0.jar` 的快捷方式复制到打开的文件夹中

## 使用说明

### 配置快捷键

1. 右键点击系统托盘图标（蓝色 "#" 符号）
2. 选择"设置快捷键..."
3. 点击要配置的按键旁边的"编辑"按钮
4. 在弹出的对话框中填写以下信息（至少填一项）：
   - **名称**：操作的描述性名称（必填）
   - **命令**：要执行的程序路径（可选，如 `notepad.exe`、`C:\Program Files\xxx\app.exe`）
   - **参数**：可选，传递给程序的参数
   - **组合键**：可选，要模拟的按键组合（如 `ctrl+s`、`alt+tab`、`ctrl+shift+a`）

5. 对于 NumPad +、NumPad - 和 NumPad Enter，可以点击"重置"按钮恢复默认的系统功能（音量控制或播放/暂停）

#### 支持的组合键格式

- **修饰键**：`ctrl`, `control`, `shift`, `alt`, `win`, `windows`
- **字母**：`a-z`
- **数字**：`0-9`
- **特殊键**：`space`, `enter`, `tab`, `esc`, `backspace`, `delete`, `insert`
- **方向键**：`left`, `right`, `up`, `down`
- **符号**：`comma`, `period`, `semicolon`, `slash`, `backslash`
- **函数键**：`f1` - `f12`
- **分隔符**：使用 `+` 连接各部分

#### 组合键示例

| 组合键 | 说明 |
|-------|------|
| `ctrl+c` | 复制 |
| `ctrl+v` | 粘贴 |
| `ctrl+s` | 保存 |
| `shift+f5` | 刷新（某些应用） |
| `alt+tab` | 切换窗口 |
| `ctrl+shift+esc` | 打开任务管理器 |
| `win+v` | 粘贴历史（Win11） |
| `ctrl+shift+comma` | 自定义组合键 |

### 配置文件

MinPad 支持配置持久化存储，您所有的设置都会自动保存。

- **配置文件位置**：`C:\Users\[用户名]\.minpad\config.json`
- **自动保存时机**：
  - 每次修改快捷键设置时立即保存
  - 应用关闭时自动保存当前配置
- **自动加载**：应用启动时会自动加载上次保存的配置

配置文件采用 JSON 格式，您可以手动编辑，但建议通过应用的图形界面修改以避免格式错误。

### 示例配置

#### 打开指定网站
- 名称：打开百度
- 命令：`explorer.exe`
- 参数：`https://www.baidu.com`
- 组合键：留空

#### 使用组合键快捷复制
- 名称：快速复制
- 命令：留空
- 参数：留空
- 组合键：`ctrl+c`

#### 使用组合键切换窗口
- 名称：切换窗口
- 命令：留空
- 参数：留空
- 组合键：`alt+tab`

#### 打开指定文件夹
- 名称：打开工作目录
- 命令：`explorer.exe`
- 参数：`C:\Users\YourName\Documents`
- 组合键：留空

#### 运行批处理脚本
- 名称：备份数据
- 命令：`C:\scripts\backup.bat`
- 参数：留空
- 组合键：留空

## 技术栈

- **Java 11+**：核心开发语言
- **Swing**：原生 GUI 界面，支持完整中文
- **JNativeHook 2.2.2**：全局键盘钩子监听库
- **JNA 5.14.0 + jna-platform**：Windows API 调用（低级键盘钩子、媒体控制）
- **Gson 2.10.1**：JSON 序列化与反序列化（配置文件管理）
- **Maven**：项目构建工具

## 项目结构

```
minpad/
├── src/
│   └── main/
│       └── java/
│           └── com/
│               └── minpad/
│                   ├── Main.java                      # 主入口
│                   ├── KeyboardHook.java              # 低级键盘钩子（拦截数字键盘）
│                   ├── NumPadListener.java            # 高级键盘监听器（备用）
│                   ├── ActionExecutor.java            # 快捷操作执行器
│                   ├── AudioVolumeController.java     # 音量和媒体控制
│                   ├── KeyCombinationController.java  # 组合键模拟器
│                   ├── ConfigManager.java             # 配置管理（JSON 序列化）
│                   ├── SystemTrayManager.java         # 系统托盘管理
│                   ├── SettingsDialog.java            # 设置对话框
│                   └── IconFactory.java               # 图标工厂（统一图标管理）
├── pom.xml                                             # Maven 配置（包含依赖和 shade 插件）
└── README.md                                           # 项目说明
```

## 常见问题

### Q: 程序无法启动？
A: 请确保已安装 Java 11 或更高版本。可以在命令行运行 `java -version` 检查。

### Q: 无法监听键盘？
A: Windows 可能需要管理员权限才能使用全局键盘钩子。请尝试以管理员身份运行。

### Q: 数字键盘按键无反应？
A: 确保 NumLock 键已开启（可在键盘上看到 NumLock 指示灯）。

### Q: 长按 NumPad +/- 时不连续调节音量？
A: 这是正常行为。程序会在您按下时立即执行一次音量调节，然后每 120ms 执行一次（直到松开按键）。

### Q: 如何卸载？
A: 直接删除 JAR 文件即可。如果设置了开机自启动，记得删除启动文件夹中的快捷方式。

### Q: 支持组合键吗？
A: ✅ **完全支持！** 可以在配置中填写 `ctrl+shift+a`、`alt+tab` 等组合键。详见"使用说明"中的"支持的组合键格式"部分。

### Q: 可以同时使用命令和组合键吗？
A: 不可以。在配置快捷键时，如果同时填写了命令和组合键，程序会优先执行组合键，忽略命令。建议只配置其中一项。

### Q: 右键菜单显示乱码？
A: 这通常是字体问题。程序会自动尝试使用系统中可用的中文字体（如 Microsoft YaHei）。如果仍有问题，可以检查系统字体设置。

### Q: 配置文件保存在哪里？
A: 配置文件保存在用户目录下的 `.minpad/config.json`，即：`C:\Users\[用户名]\.minpad\config.json`。每次修改设置都会自动保存。

### Q: 如何重置为默认配置？
A: 对于 NumPad +/- 和 NumPad Enter 这三个按键，在设置对话框中点击"重置"按钮可以恢复为默认功能。要完全重置所有配置，可以删除 `C:\Users\[用户名]\.minpad\config.json` 文件，重启应用即可。

### Q: 配置会在哪些情况下保存？
A: 配置在以下两个时机会自动保存：
1. **编辑时立即保存**：每次在设置对话框中点击"确定"后，修改会立即保存到文件
2. **应用关闭时保存**：应用正常退出时，所有当前配置会再次保存一遍

### Q: 可以手动编辑配置文件吗？
A: 可以，配置文件是标准的 JSON 格式。但建议通过应用的图形界面修改，避免手工编辑导致的格式错误。如果手动修改了配置文件，需要重启应用才能生效。

## 更新日志

### v1.1.0 (最新版本)

#### 新增功能
- ✨ **配置持久化存储**：配置文件自动保存到 `~/.minpad/config.json`
- ✨ 应用启动时自动加载上次的配置
- ✨ 编辑快捷键后立即保存，关闭应用时也会保存所有配置

#### 改进
- 🔧 增强配置管理，支持 JSON 格式配置文件
- 🔧 完整的配置备份和恢复机制

### v1.0.0

#### 新增功能
- ✨ 支持组合键映射（Ctrl+Shift+A、Alt+Tab 等）
- ✨ NumPad Enter 默认实现播放/暂停功能
- ✨ 长按 NumPad +/- 连续调节音量，松开立即停止
- ✨ 完整的中文用户界面和菜单

#### 改进
- 🔧 优化音量控制为每次 1 格而非 2 格
- 🔧 全局键盘钩子完全拦截数字键盘，防止其他应用接收
- 🔧 改进托盘菜单显示，使用 Swing 自绘确保中文显示正确
- 🔧 统一 UI 图标设计，设置窗口与托盘图标保持一致
- 🔧 完整的错误处理和日志输出

#### 技术优化
- 采用低级键盘钩子 (WH_KEYBOARD_LL) + 高级监听器双层架构
- 使用 JNA 直接调用 Windows API 实现音量和媒体控制
- 定时任务机制处理长按连续触发

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！

## 联系方式

如有问题或建议，欢迎通过 GitHub Issues 反馈。
